<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Cask Data, Inc." name="author" />
<meta content="Copyright © 2014 Cask Data, Inc." name="copyright" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-55081520-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Best Practices for Developing Applications &mdash; Cask Data Application Platform 2.6.0 Documentation</title>
    
    <link rel="stylesheet" href="../_static/cdap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    



    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Cask Data Application Platform 2.6.0 Documentation" href="../index.html" />
    <link rel="up" title="Advanced Topics" href="index.html" />
    <link rel="prev" title="Data Exploration" href="data-exploration.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">Index</a></li>
        <li class="right" >
          <a href="data-exploration.html" title="Data Exploration"
             accesskey="P">Previous</a> |</li>
        
        <script type="text/javascript" src="../_static/version-menu.js"></script>
        <script src="http://docs.cask.co/cdap/json-versions.js"/></script>
        <script>window.setVersion('2.6.0');</script>
       
        <li><a href="../table-of-contents.html">CDAP Developers’ Manual</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Advanced Topics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="best-practices-for-developing-applications">
<h1>Best Practices for Developing Applications<a class="headerlink" href="#best-practices-for-developing-applications" title="Permalink to this headline">¶</a></h1>
<div class="section" id="initializing-instance-fields">
<h2>Initializing Instance Fields<a class="headerlink" href="#initializing-instance-fields" title="Permalink to this headline">¶</a></h2>
<p>There are three ways to initialize instance fields used in Flowlets and Procedures:</p>
<ol class="arabic simple">
<li>Using the default constructor;</li>
<li>Using the <tt class="docutils literal"><span class="pre">initialize()</span></tt> method of the Flowlets and Procedures; and</li>
<li>Using <tt class="docutils literal"><span class="pre">&#64;Property</span></tt> annotations.</li>
</ol>
<p>To initialize using an Property annotation, simply annotate the field definition with
<tt class="docutils literal"><span class="pre">&#64;Property</span></tt>.</p>
<p>The following example demonstrates the convenience of using <tt class="docutils literal"><span class="pre">&#64;Property</span></tt> in a
<tt class="docutils literal"><span class="pre">WordFilter</span></tt> flowlet
that filters out specific words:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">WordFilter</span> <span class="kd">extends</span> <span class="n">AbstractFlowlet</span> <span class="o">{</span>

  <span class="kd">private</span> <span class="n">OutputEmitter</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">out</span><span class="o">;</span>

  <span class="nd">@Property</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">toFilterOut</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">CountByField</span><span class="o">(</span><span class="n">String</span> <span class="n">toFilterOut</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">toFilterOut</span> <span class="o">=</span> <span class="n">toFilterOut</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@ProcessInput</span><span class="o">()</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">process</span><span class="o">(</span><span class="n">String</span> <span class="n">word</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">toFilterOut</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">word</span><span class="o">))</span> <span class="o">{</span>
      <span class="n">out</span><span class="o">.</span><span class="na">emit</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The Flowlet constructor is called with the parameter when the Flow is configured:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">WordCountFlow</span> <span class="kd">implements</span> <span class="n">Flow</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">FlowSpecification</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">FlowSpecification</span><span class="o">.</span><span class="na">Builder</span><span class="o">.</span><span class="na">with</span><span class="o">()</span>
      <span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;WordCountFlow&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="s">&quot;Flow for counting words&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="na">withFlowlets</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">Tokenizer</span><span class="o">())</span>
                     <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">WordsFilter</span><span class="o">(</span><span class="s">&quot;the&quot;</span><span class="o">))</span>
                     <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">WordsCounter</span><span class="o">())</span>
      <span class="o">.</span><span class="na">connect</span><span class="o">().</span><span class="na">fromStream</span><span class="o">(</span><span class="s">&quot;text&quot;</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="s">&quot;Tokenizer&quot;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">&quot;Tokenizer&quot;</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="s">&quot;WordsFilter&quot;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">&quot;WordsFilter&quot;</span><span class="o">).</span><span class="na">to</span><span class="o">(</span><span class="s">&quot;WordsCounter&quot;</span><span class="o">)</span>
      <span class="o">.</span><span class="na">build</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>At run-time, when the Flowlet is started, a value is injected into the <tt class="docutils literal"><span class="pre">toFilterOut</span></tt>
field.</p>
<p>Field types that are supported using the <tt class="docutils literal"><span class="pre">&#64;Property</span></tt> annotation are primitives,
boxed types (e.g. <tt class="docutils literal"><span class="pre">Integer</span></tt>), <tt class="docutils literal"><span class="pre">String</span></tt> and <tt class="docutils literal"><span class="pre">enum</span></tt>.</p>
</div>
<div class="section" id="scanning-over-tables-with-byte-keys">
<h2>Scanning Over Tables with <tt class="docutils literal"><span class="pre">byte[]</span></tt> Keys<a class="headerlink" href="#scanning-over-tables-with-byte-keys" title="Permalink to this headline">¶</a></h2>
<p>In the CDAP Java API,
<a class="reference external" href="../../reference-manual/javadocs/co/cask/cdap/api/common/Bytes.html#stopKeyForPrefix(byte[])">Bytes.stopKeyForPrefix()</a>
is a very handy tool when performing scans over tables with <tt class="docutils literal"><span class="pre">byte[]</span></tt> keys.</p>
<p>The method returns a given prefix, incremented by one, in a form that is suitable for
prefix matching. Here is an example, showing <tt class="docutils literal"><span class="pre">stopKeyForPrefix</span></tt> being used to generate,
from a provided index key, an incremented stop key:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="c1">// Returns first that matches</span>
<span class="nd">@Nullable</span>
<span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="n">get</span><span class="o">(</span><span class="n">Key</span> <span class="n">id</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">classOfT</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">try</span> <span class="o">{</span>
    <span class="n">Scanner</span> <span class="n">scan</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="na">scan</span><span class="o">(</span><span class="n">id</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">Bytes</span><span class="o">.</span><span class="na">stopKeyForPrefix</span><span class="o">(</span><span class="n">id</span><span class="o">.</span><span class="na">getKey</span><span class="o">()));</span>
    <span class="n">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="n">scan</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">row</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">row</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kt">byte</span><span class="o">[]</span> <span class="n">value</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">COLUMN</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="nf">deserialize</span><span class="o">(</span><span class="n">value</span><span class="o">,</span> <span class="n">classOfT</span><span class="o">);</span>
  <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="n">Throwables</span><span class="o">.</span><span class="na">propagate</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="manuals links">
    <h3><a href="../table-of-contents/../../index.html"
        rel="nofollow">CDAP Documentation v2.6.0</a></h3>
    <ul class="this-page-menu">
      <li><a href="../table-of-contents/../../index.html"
            rel="nofollow">Introduction</a></li>
      <li><b><a href="../table-of-contents/../../developers-manual/index.html"
            rel="nofollow">Developers’ Manual</a></b></li>
      <li><a href="../table-of-contents/../../admin-manual/index.html"
            rel="nofollow">Administration Manual</a></li>
      <li><a href="../table-of-contents/../../examples-manual/index.html"
            rel="nofollow">Examples, Guides, and Tutorials</a></li>
      <li><a href="../table-of-contents/../../reference-manual/index.html"
            rel="nofollow">Reference Manual</a></li>
      <li><a href="../table-of-contents/../../reference-manual/release-notes.html"
            rel="nofollow">Release Notes</a></li>
      <li><a href="../table-of-contents/../../reference-manual/glossary.html"
            rel="nofollow">Glossary</a></li>
      <li><a href="../table-of-contents/../../reference-manual/faq.html"
            rel="nofollow">FAQ</a></li>
    </ul>
   </div><!--
  Copyright © 2014 Cask Data, Inc.

  Licensed under the Apache License, Version 2.0 (the "License"); you may not
  use this file except in compliance with the License. You may obtain a copy of
  the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  License for the specific language governing permissions and limitations under
  the License.
-->


<h3 class="pagenavtitle"><a href="../table-of-contents.html">Developers’ Manual: Table&nbsp;of&nbsp;Contents</a></h3>
<nav class="pagenav">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html"> Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html"> Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html"> Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building-blocks/index.html"> Building Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html"> Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html"> Testing and Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ingesting-tools/index.html"> Ingesting Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html"> Advanced Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data-exploration.html"> Data Exploration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href=""> Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initializing-instance-fields">Initializing Instance Fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scanning-over-tables-with-byte-keys">Scanning Over Tables with <tt class="docutils literal"><span class="pre">byte[]</span></tt> Keys</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</nav>
  <h4>Previous Topic</h4>
  <p class="topless"><a href="data-exploration.html"
                        title="Previous Chapter">Data Exploration</a></p>
  <div role="note" aria-label="downloads links">
    <h3>Downloads</h3>
    <ul class="this-page-menu">
      <li><a href="http://docs.cask.co/cdap/2.6.0/cdap-docs-2.6.0-web.zip"
            rel="nofollow">Zip Archive of CDAP Documentation</a></li>
    </ul>
   </div>
  
<div id="searchbox" style="display: none" role="search">
  <h3>Quick Search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;margin:0px auto;}
.tg td{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg th{padding:0px 20px 0px 20px;border-width:0px;overflow:hidden;word-break:normal;font-weight:normal;}
.tg .tg-s6z2{text-align:center;}
.tg .tg-0ord{text-align:right;}
.tg a{font-weight:bold;}
</style>
<table class="tg" width= 100%>
  <tr>
    <th class="tg-031e">Previous Topic: 
    <a title="Data Exploration" href="data-exploration.html" />Data Exploration</a>&nbsp;&nbsp;
    
    </th>
    <th class="tg-s6z2">
        &copy; Copyright 2014-2015 Cask Data, Inc.
    
    </th>
    <th class="tg-0ord">
    
    </th>
  </tr>
</table>

    </div>
  </body>
</html>